#!/bin/sh
#
# shell script to delete Bacula tables for PostgreSQL

bindir=@SQL_BINDIR@
PATH="$bindir:$PATH"
db_name=${db_name:-@db_name@}
db_user=${db_user:-@db_user@}

sql -u${db_user} ${db_name} $* <<END-OF-DATA
DROP TABLE filename;
DROP TABLE path;
DROP TABLE file;
DROP TABLE Job;
DROP TABLE JobHisto;
DROP TABLE Location;
DROP TABLE fileset;
DROP TABLE jobmedia;
DROP TABLE media;
DROP TABLE MediaType;
DROP TABLE Storage;
DROP TABLE Device;
DROP TABLE pool;
DROP TABLE client;
DROP TABLE Log;
DROP TABLE LocationLog;
DROP TABLE counters;
DROP TABLE basefiles;
DROP TABLE unsavedfiles;
DROP TABLE CDImages ;
DROP TABLE PathHierarchy;
DROP TABLE PathVisibility;
DROP TABLE version;
DROP TABLE Status;
DROP SEQUENCE filename_seq;
DROP SEQUENCE path_seq;
DROP SEQUENCE file_seq;
DROP SEQUENCE Job_seq;
DROP SEQUENCE JobHisto_seq;
DROP SEQUENCE Location_seq;
DROP SEQUENCE fileset_seq;
DROP SEQUENCE jobmedia_seq;
DROP SEQUENCE media_seq;
DROP SEQUENCE MediaType_seq;
DROP SEQUENCE Storage_seq;
DROP SEQUENCE Device_seq;
DROP SEQUENCE pool_seq;
DROP SEQUENCE client_seq;
DROP SEQUENCE Log_seq;
DROP SEQUENCE LocationLog_seq;
DROP SEQUENCE basefiles_seq;
\g
END-OF-DATA
pstat=$?
if test $pstat = 0; 
then
   echo "Deletion of Bacula Ingres tables succeeded."
else
   echo "Deletion of Bacula Ingres tables failed."
fi
exit $pstat
